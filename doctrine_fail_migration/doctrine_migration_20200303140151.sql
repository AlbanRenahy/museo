-- Doctrine Migration File Generated on 2020-03-03 14:01:51

-- Version 20200302135949
CREATE TABLE user (id INT AUTO_INCREMENT NOT NULL, email VARCHAR(180) NOT NULL, roles JSON NOT NULL, password VARCHAR(255) NOT NULL, UNIQUE INDEX UNIQ_8D93D649E7927C74 (email), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE monument_thematic (monument_id INT NOT NULL, thematic_id INT NOT NULL, INDEX IDX_6E65D8FA493DA1E5 (monument_id), INDEX IDX_6E65D8FA2395FCED (thematic_id), PRIMARY KEY(monument_id, thematic_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
ALTER TABLE monument_thematic ADD CONSTRAINT FK_6E65D8FA493DA1E5 FOREIGN KEY (monument_id) REFERENCES monument (id) ON DELETE CASCADE;
ALTER TABLE monument_thematic ADD CONSTRAINT FK_6E65D8FA2395FCED FOREIGN KEY (thematic_id) REFERENCES thematic (id) ON DELETE CASCADE;
ALTER TABLE region ADD monument_id INT DEFAULT NULL;
ALTER TABLE region ADD CONSTRAINT FK_F62F176493DA1E5 FOREIGN KEY (monument_id) REFERENCES monument (id);
CREATE INDEX IDX_F62F176493DA1E5 ON region (monument_id);
ALTER TABLE period ADD monument_id INT DEFAULT NULL;
ALTER TABLE period ADD CONSTRAINT FK_C5B81ECE493DA1E5 FOREIGN KEY (monument_id) REFERENCES monument (id);
CREATE INDEX IDX_C5B81ECE493DA1E5 ON period (monument_id);
ALTER TABLE target ADD monument_id INT DEFAULT NULL;
ALTER TABLE target ADD CONSTRAINT FK_466F2FFC493DA1E5 FOREIGN KEY (monument_id) REFERENCES monument (id);
CREATE INDEX IDX_466F2FFC493DA1E5 ON target (monument_id);
ALTER TABLE monument DROP thematic;
INSERT INTO migration_versions (version, executed_at) VALUES ('20200302135949', CURRENT_TIMESTAMP);

-- Version 20200302154603
ALTER TABLE user ADD firstname VARCHAR(255) NOT NULL, ADD lastname VARCHAR(255) NOT NULL, ADD picture VARCHAR(255) DEFAULT NULL, ADD register_at DATETIME NOT NULL, ADD birth_date DATETIME DEFAULT NULL, ADD username VARCHAR(255) NOT NULL;
INSERT INTO migration_versions (version, executed_at) VALUES ('20200302154603', CURRENT_TIMESTAMP);

-- Version 20200302154644
ALTER TABLE user ADD firstname VARCHAR(255) NOT NULL, ADD lastname VARCHAR(255) NOT NULL, ADD picture VARCHAR(255) DEFAULT NULL, ADD register_at DATETIME NOT NULL, ADD username VARCHAR(255) NOT NULL;
INSERT INTO migration_versions (version, executed_at) VALUES ('20200302154644', CURRENT_TIMESTAMP);

-- Version 20200303130009
ALTER TABLE user ADD username VARCHAR(255) NOT NULL, ADD pseudo VARCHAR(255) NOT NULL;
INSERT INTO migration_versions (version, executed_at) VALUES ('20200303130009', CURRENT_TIMESTAMP);
